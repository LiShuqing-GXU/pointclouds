function [D,U] = pnpairs(pn)
    
    D = zeros( size(pn,2) );
    U = zeros( size(pn,2) );
    
    for idx = 1:size(pn,2)
        for jdx = idx:size(pn,2)
            if idx == jdx
                
            D(idx,jdx) = norm( pn(1:3,idx) - pn(1:3,jdx) );
            U(idx,jdx) = dot(  pn(4:6,idx) , pn(4:6,jdx) );
            D(jdx,idx) = D(idx,jdx);
            U(jdx,idx) = U(idx,jdx);
        end
    end
end